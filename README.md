# 요구사항
## 기본
- 작가명(author)와 명언내용(content)에는 특수문자를 입력되지 않는다.
- 최대한 라이브러리를 사용하지 않고 구현
    - 다만 자바에 기본적으로 내장된 기능은 최대한 활용해도 됩니다.
- assertThat 의존성 : `testImplementation("org.assertj:assertj-core:3.26.3")`

## 1 단계
### 종료
```
== 명언 앱 ==
명령) 종료
```

## 2 단계
### 등록
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
명령) 종료
```

## 3 단계
### 등록시 생성된 명언번호 노출
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 종료
```

## 4 단계
### 등록할때 마다 생성되는 명언번호가 증가
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 종료
```

## 5 단계
### 목록
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 종료
```

## 6 단계
### 1번 명언삭제
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 삭제?id=1
1번 명언이 삭제되었습니다.
명령) 종료
```

## 7 단계
### 존재하지 않는 명언삭제에 대한 예외처리
- 한번 삭제된 명언의 번호는 재사용하지 않는다.
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 삭제?id=1
1번 명언이 삭제되었습니다.
명령) 삭제?id=1
1번 명언은 존재하지 않습니다.
명령) 종료
```

## 8 단계
### 명언수정
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 삭제?id=1
1번 명언이 삭제되었습니다.
명령) 삭제?id=1
1번 명언은 존재하지 않습니다.
명령) 수정?id=3
3번 명언은 존재하지 않습니다.
명령) 수정?id=2
명언(기존) : 과거에 집착하지 마라.
명언 : 현재와 자신을 사랑하라.
작가(기존) : 작자미상
작가 : 홍길동
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 홍길동 / 현재와 자신을 사랑하라.
명령) 종료
```

## 9 단계
### 파일을 통한 영속성
- 각 명언은 개별파일로 `db/wiseSaying` 폴더에 저장
- 각 명언 파일명 `{명언번호}.json`
    - 명언을 등록할 때 마다, 수정할 때 마다 해당 파일이 갱신되어야 합니다.
- 가장 마지막에 생성된 명언 번호는 `db/wiseSaying/lastId.txt` 파일에 숫자로 저장
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 종료

프로그램 다시 시작...

== 명언 앱 ==
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
```

### 파일 구조
- db/wiseSaying/1.json
- db/wiseSaying/2.json
- db/wiseSaying/lastId.txt

### db/wiseSaying/1.json 파일 내용
```json
{
  "id": 1,
  "content": "명언 1",
  "author": "작가 1"
}
```

### db/wiseSaying/2.json 파일 내용
```json
{
  "id": 2,
  "content" : "명언 2",
  "author": "작가 2"
}
```

### db/wiseSaying/lastId.txt 파일 내용(가장 마지막에 생성된 명언 번호가 저장됨)
```
2
```

## 10 단계
### data.json 빌드(빌드라는 명령이 입력되면 모든 명언들을 모아서 data.json 파일 생성)
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 삭제?id=1
1번 명언이 삭제되었습니다.
명령) 삭제?id=1
1번 명언은 존재하지 않습니다.
명령) 수정?id=2
명언(기존) : 과거에 집착하지 마라.
명언 : 현재와 자신을 사랑하라.
작가(기존) : 작자미상
작가 : 홍길동
명령) 목록
번호 / 작가 / 명언
----------------------
2 / 홍길동 / 현재와 자신을 사랑하라.
명령) 빌드
data.json 파일의 내용이 갱신되었습니다.
명령) 종료
```

## data.json 양식
```json
[
  {
    "id": 1,
    "content": "명언 1",
    "author": "작가 1"
  },
  {
    "id": 2,
    "content" : "명언 2",
    "author": "작가 2"
  }
]
```

## 11 단계
- Controller, Service, Repository 구조 도입
    - 스프링부트의 일반적인 구조 참고
- 고객의 요청 처리 흐름
    - 컨트롤러 => 서비스 => 리포지터리 => 파일DB
- 추천구조
    - com.ll.wiseSaying.Main
        - 역할 : App 실행
    - com.ll.wiseSaying.App
        - 역할 : 사용자 입력을 받고 그것이 WiseSayingController 에게 넘거야 하는지 판단해서 맞으면 넘김(넘김의 의미 : 메서드 호출(인자와 함께))
        - 이 단계에서는 스캐너 사용가능
        - 이 단계에서는 출력 사용가능
    - com.ll.wiseSaying.WiseSayingController.java
        - 역할 : 고객의 명령을 입력받고 적절을 응답을 표현
        - 이 단계에서는 스캐너 사용가능
        - 이 단계에서는 출력 사용가능
    - com.ll.wiseSaying.WiseSayingService.java
        - 역할 : 순수 비지니스 로직
        - 스캐너 사용금지, 출력 금지
    - com.ll.wiseSaying.WiseSayingRepository.java
        - 역할 : 데이터의 조회/수정/삭제/생성을 담당
        - 스캐너 사용금지, 출력 금지
    - com.ll.wiseSaying.WiseSaying.java
        - 역할 : 명언 객체(번호/명언내용/작가)
        - 이 파일은 컨트롤러, 서비스, 리포지터티 모두에서 사용가능

## 12 단계
- TDD 적용(JUNIT 사용)
- 표준입출력 리다이렉팅에 대해서 학습 후 진행
- 통합 테스트만 진행, 단위 테스트는 안해도 됩니다.
- 즉 각 명령어별 테스트만 진행하시면 됩니다.

## 테스트 예시
```java
public class WiseSayingControllerTest {
    @BeforeEach
    void beforeEach() {
        AppTest.clear();
    }

    @Test
    @DisplayName("등록")
    void t3() {
        final String out = AppTest.run("""
                등록
                현재를 사랑하라.
                작자미상
                """);

        assertThat(out)
                .contains("명언 :")
                .contains("작가 :")
                .contains("1번 명언이 등록되었습니다.");
    }
    
    // ...
}
```

## TestUtil
```java
import java.io.*;
import java.util.Scanner;

public class TestUtil {
    // gen == generate 생성하다.
    // 테스트용 스캐너 생성
    public static Scanner genScanner(final String input) {
        final InputStream in = new ByteArrayInputStream(input.getBytes());

        return new Scanner(in);
    }

    // System.out의 출력을 스트림으로 받기
    public static ByteArrayOutputStream setOutToByteArray() {
        final ByteArrayOutputStream output = new ByteArrayOutputStream();
        System.setOut(new PrintStream(output));

        return output;
    }

    // setOutToByteArray 함수의 사용을 완료한 후 정리하는 함수, 출력을 다시 정상화 하는 함수
    public static void clearSetOutToByteArray(final ByteArrayOutputStream output) {
        System.setOut(new PrintStream(new FileOutputStream(FileDescriptor.out)));
        try {
            output.close();
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
}
```

## JUNIT 사용법
```java
package com.ll;

import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

class AppTest {
    @Test
    public void 더하기() {
        assertEquals(30, 30);
    }
}
```


## 13 단계
### 검색
```
== 명언 앱 ==
명령) 등록
명언 : 현재를 사랑하라.
작가 : 작자미상
1번 명언이 등록되었습니다.
명령) 등록
명언 : 과거에 집착하지 마라.
작가 : 작자미상
2번 명언이 등록되었습니다.
명령) 목록?keywordType=content&amp;amp;keyword=과거
----------------------
검색타입 : content
검색어 : 과거
----------------------
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
명령) 목록?keywordType=author&amp;amp;keyword=작자
----------------------
검색타입 : author
검색어 : 작자
----------------------
번호 / 작가 / 명언
----------------------
2 / 작자미상 / 과거에 집착하지 마라.
1 / 작자미상 / 현재를 사랑하라.
명령) 종료
```

## 14 단계
### 페이징
- 이 단계부터는 목록명령어에서 모든 명언을 볼 수 없고 페이징 된다.
- 샘플 데이터 명언 10개 생성
- 한 페이지에 최대 5개의 명언이 노출
- 페이지 번호를 생략하면 1 페이지로 간주합니다.
- 최신글이 우선적으로 나와야 합니다.
- 검색어를 적용하면 그것을 반영한 페이징이 되어야 합니다.
```
== 명언 앱 ==
명령) 목록
번호 / 작가 / 명언
----------------------
10 / 작자미상 10 / 명언 10
9 / 작자미상 9 / 명언 9
8 / 작자미상 8 / 명언 8
7 / 작자미상 7 / 명언 7
6 / 작자미상 6 / 명언 6
----------------------
페이지 : [1] / 2
명령) 목록?page=2
번호 / 작가 / 명언
----------------------
5 / 작자미상 5 / 명언 5
4 / 작자미상 4 / 명언 4
3 / 작자미상 3 / 명언 3
2 / 작자미상 2 / 명언 2
1 / 작자미상 1 / 명언 1
----------------------
페이지 : 1 / [2]
명령) 종료
```

